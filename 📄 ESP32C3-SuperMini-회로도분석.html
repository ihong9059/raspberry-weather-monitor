<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP32-C3 SuperMini 회로도 분석 (정확한 버전)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .section h2 {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }

        .section h3 {
            color: #764ba2;
            font-size: 1.4em;
            margin: 25px 0 15px 0;
        }

        .pin-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .pin-table th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .pin-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .pin-table tr:hover {
            background: #f5f5f5;
        }

        .pin-table .gpio-pin {
            font-weight: bold;
            color: #667eea;
        }

        .pin-table .function {
            color: #764ba2;
            font-weight: 500;
        }

        .highlight-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .highlight-box.important {
            background: #f8d7da;
            border-left-color: #dc3545;
        }

        .highlight-box.success {
            background: #d4edda;
            border-left-color: #28a745;
        }

        .highlight-box h4 {
            margin-bottom: 10px;
            color: #856404;
        }

        .highlight-box.important h4 {
            color: #721c24;
        }

        .highlight-box.success h4 {
            color: #155724;
        }

        ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        li {
            margin-bottom: 8px;
        }

        code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #d63384;
        }

        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            margin-right: 10px;
        }

        .badge.i2c { background: #17a2b8; color: white; }
        .badge.uart { background: #28a745; color: white; }
        .badge.gpio { background: #6c757d; color: white; }
        .badge.power { background: #dc3545; color: white; }

        .warning-banner {
            background: #fff3cd;
            border: 3px solid #ffc107;
            padding: 25px;
            margin: 30px 0;
            border-radius: 10px;
            text-align: center;
        }

        .warning-banner h3 {
            color: #856404;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .connection-diagram {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .connection-diagram pre {
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.8;
            overflow-x: auto;
            background: #f5f5f5;
            padding: 20px;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }

        footer {
            background: #2d3748;
            color: white;
            padding: 30px;
            text-align: center;
        }

        footer p {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🔌 ESP32-C3 SuperMini 회로도 분석 (정확한 버전)</h1>
            <p class="subtitle">온습도 모니터링 시스템 하드웨어 상세 분석</p>
        </header>

        <div class="content">
            <div class="warning-banner">
                <h3>⚠️ 중요: 이전 문서 오류 정정</h3>
                <p><strong>이전 회로도 분석에서 핀 배치를 잘못 표기했습니다!</strong></p>
                <p>이 문서는 <code>esp32c3_ai_super.pdf</code> 회로도를 정확히 재분석한 버전입니다.</p>
                <p><strong>주요 수정사항:</strong> GPIO20=RX (not TX), GPIO21=TX (not RX)</p>
            </div>

            <!-- ESP32C3 핀맵 -->
            <div class="section">
                <h2>📍 ESP32-C3 SuperMini 정확한 GPIO 핀맵</h2>

                <div class="highlight-box important">
                    <h4>⚠️ 왜 이전에 잘못 표기했나?</h4>
                    <p><strong>원인:</strong> PDF 회로도의 핀 번호 레이블을 시각적으로 오독했습니다.</p>
                    <p><strong>문제점:</strong></p>
                    <ul>
                        <li>회로도에서 U1 핀 배치를 좌→우, 위→아래 순서로 잘못 읽음</li>
                        <li>특히 오른쪽 핀들(9-16)의 순서를 거꾸로 해석</li>
                        <li>TX/RX 표기가 회로도 net label과 실제 GPIO 번호를 혼동</li>
                    </ul>
                    <p><strong>해결:</strong> 회로도의 각 핀에 직접 연결된 net label을 정확히 추적하여 재작성</p>
                    <p><strong>PROJECT-STATUS.md에 기록:</strong> 향후 세션에서 회로도 분석 시 주의사항 명시</p>
                </div>

                <h3>ESP32C3-SuperMini 핀 배치 (회로도 기준)</h3>

                <table class="pin-table">
                    <thead>
                        <tr>
                            <th>핀 번호</th>
                            <th>GPIO</th>
                            <th>회로도 연결 (Net Label)</th>
                            <th>연결 대상</th>
                            <th>프로토콜/용도</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td class="gpio-pin">GPIO5</td>
                            <td class="function">SWITCH</td>
                            <td>SW1 (택트 스위치)</td>
                            <td><span class="badge gpio">GPIO 입력</span></td>
                        </tr>
                        <tr style="background: #e7f3ff;">
                            <td>2</td>
                            <td class="gpio-pin">GPIO6</td>
                            <td class="function">SDA ⭐</td>
                            <td>AHT20 SDA, OLED SDA</td>
                            <td><span class="badge i2c">I2C Data</span></td>
                        </tr>
                        <tr style="background: #e7f3ff;">
                            <td>3</td>
                            <td class="gpio-pin">GPIO7</td>
                            <td class="function">SCL ⭐</td>
                            <td>AHT20 SCL, OLED SCL</td>
                            <td><span class="badge i2c">I2C Clock</span></td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td class="gpio-pin">GPIO8</td>
                            <td class="function">SCK</td>
                            <td>테스트 포인트</td>
                            <td><span class="badge gpio">예비 (SPI Clock)</span></td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td class="gpio-pin">GPIO9</td>
                            <td class="function">MISO</td>
                            <td>테스트 포인트</td>
                            <td><span class="badge gpio">예비 (SPI MISO)</span></td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td class="gpio-pin">GPIO10</td>
                            <td class="function">MOSI</td>
                            <td>테스트 포인트</td>
                            <td><span class="badge gpio">예비 (SPI MOSI)</span></td>
                        </tr>
                        <tr style="background: #e7ffe7;">
                            <td>7</td>
                            <td class="gpio-pin">GPIO20</td>
                            <td class="function">RX ✅</td>
                            <td>테스트 포인트</td>
                            <td><span class="badge uart">UART Receive</span></td>
                        </tr>
                        <tr style="background: #e7ffe7;">
                            <td>8</td>
                            <td class="gpio-pin">GPIO21</td>
                            <td class="function">TX ✅</td>
                            <td>테스트 포인트</td>
                            <td><span class="badge uart">UART Transmit</span></td>
                        </tr>
                        <tr>
                            <td>9</td>
                            <td class="gpio-pin">GPIO0</td>
                            <td class="function">SS ✅</td>
                            <td>테스트 포인트 (SPI Slave Select)</td>
                            <td><span class="badge gpio">예비 (SPI SS)</span></td>
                        </tr>
                        <tr>
                            <td>10</td>
                            <td class="gpio-pin">GPIO1</td>
                            <td class="function">DIN ✅</td>
                            <td>WS2812 LED Data In</td>
                            <td><span class="badge gpio">GPIO 출력</span></td>
                        </tr>
                        <tr>
                            <td>11</td>
                            <td class="gpio-pin">GPIO2</td>
                            <td class="function">SPEAKER</td>
                            <td>Q1 (트랜지스터) → BUZZER</td>
                            <td><span class="badge gpio">GPIO 출력</span></td>
                        </tr>
                        <tr>
                            <td>12</td>
                            <td class="gpio-pin">GPIO3</td>
                            <td class="function">TP2 ✅</td>
                            <td>테스트 포인트 2</td>
                            <td><span class="badge gpio">범용 GPIO</span></td>
                        </tr>
                        <tr>
                            <td>13</td>
                            <td class="gpio-pin">GPIO4</td>
                            <td class="function">TP1 ✅</td>
                            <td>테스트 포인트 1</td>
                            <td><span class="badge gpio">범용 GPIO</span></td>
                        </tr>
                        <tr>
                            <td>14</td>
                            <td colspan="2" class="function">3V3</td>
                            <td>전원 출력 (3.3V)</td>
                            <td><span class="badge power">POWER</span></td>
                        </tr>
                        <tr>
                            <td>15</td>
                            <td colspan="2" class="function">GND</td>
                            <td>접지</td>
                            <td><span class="badge power">GND</span></td>
                        </tr>
                        <tr>
                            <td>16</td>
                            <td colspan="2" class="function">5V</td>
                            <td>전원 입력 (5V USB)</td>
                            <td><span class="badge power">POWER</span></td>
                        </tr>
                    </tbody>
                </table>

                <div class="highlight-box success">
                    <h4>✅ 정확한 UART 연결</h4>
                    <ul>
                        <li><strong>GPIO20 (핀7):</strong> RX (Receive) - 데이터 수신</li>
                        <li><strong>GPIO21 (핀8):</strong> TX (Transmit) - 데이터 송신</li>
                    </ul>
                    <p><strong>참고:</strong> 일반적인 UART 통신에서 크로스 연결 필요</p>
                    <ul>
                        <li>ESP32 TX → 상대방 RX</li>
                        <li>ESP32 RX → 상대방 TX</li>
                    </ul>
                </div>
            </div>

            <!-- I2C 연결 -->
            <div class="section">
                <h2>🔗 I2C 버스 연결 (AHT20 센서)</h2>

                <div class="highlight-box success">
                    <h4>✅ 현재 프로젝트에서 사용 중 (정확)</h4>
                    <ul>
                        <li><strong>SDA:</strong> GPIO6 (핀2)</li>
                        <li><strong>SCL:</strong> GPIO7 (핀3)</li>
                        <li><strong>센서:</strong> AHT20 (I2C 주소 0x38)</li>
                        <li><strong>풀업:</strong> R2 = 10K Ω</li>
                    </ul>
                </div>

                <div class="connection-diagram">
                    <h4>I2C 연결 다이어그램</h4>
                    <pre>
ESP32-C3 SuperMini                      AHT20 센서
┌─────────────────┐                     ┌──────────┐
│                 │                     │          │
│  핀2 GPIO6  ────┼─────────────────────┼─ SDA    │
│      (SDA)      │         ↑           │   (핀2)  │
│                 │      10K (R2)       │          │
│                 │         │           │          │
│  핀3 GPIO7  ────┼─────────────────────┼─ SCL    │
│      (SCL)      │                     │   (핀3)  │
│                 │                     │          │
│  핀14 3V3   ────┼─────────────────────┼─ VCC    │
│                 │                     │   (핀1)  │
│                 │                     │          │
│  핀15 GND   ────┼─────────────────────┼─ GND    │
│                 │                     │   (핀4)  │
└─────────────────┘                     └──────────┘

I2C 주소: 0x38
속도: 100kHz (표준) 또는 400kHz (고속)
                    </pre>
                </div>
            </div>

            <!-- 주요 구성 요소 -->
            <div class="section">
                <h2>🔧 회로도의 주요 구성 요소</h2>

                <h3>1. ESP32-C3 SuperMini (U1)</h3>
                <ul>
                    <li>16핀 모듈</li>
                    <li>RISC-V 32-bit 프로세서</li>
                    <li>WiFi + BLE 내장</li>
                    <li>USB CDC 지원 (시리얼 통신)</li>
                </ul>

                <h3>2. AHT20 온습도 센서 (U2)</h3>
                <ul>
                    <li>4핀 I2C 센서 (2542WR-04P 커넥터)</li>
                    <li>핀1: VDD (3.3V)</li>
                    <li>핀2: SDA → GPIO6</li>
                    <li>핀3: SCL → GPIO7</li>
                    <li>핀4: VSS (GND)</li>
                </ul>

                <h3>3. OLED 디스플레이 (U3)</h3>
                <ul>
                    <li>4핀 I2C 디스플레이 (2542WR-04P 커넥터)</li>
                    <li>같은 I2C 버스 공유 (GPIO6, GPIO7)</li>
                    <li>현재 프로젝트에서 미사용</li>
                </ul>

                <h3>4. WS2812 RGB LED (U4)</h3>
                <ul>
                    <li>GPIO3 (DIN)으로 제어</li>
                    <li>5V 전원 사용</li>
                </ul>

                <h3>5. 택트 스위치 (SW1)</h3>
                <ul>
                    <li>GPIO5 연결</li>
                    <li>R1 (10K) 풀업</li>
                    <li>C1 (100nF) 디바운싱</li>
                </ul>

                <h3>6. 부저 (BUZZER1)</h3>
                <ul>
                    <li>GPIO2 → Q1 (BCX56 트랜지스터) → BUZZER</li>
                    <li>R3 (10K) 풀업</li>
                    <li>2.7kHz 공진 주파수</li>
                </ul>

                <h3>7. 테스트 포인트 (TP1-TP8)</h3>
                <ul>
                    <li>TP1: GPIO0</li>
                    <li>TP2: GPIO1</li>
                    <li>TP3-TP8: TX, RX, SCK, MISO, MOSI, SS</li>
                </ul>
            </div>

            <!-- 전원 구조 -->
            <div class="section">
                <h2>⚡ 전원 구조</h2>

                <div class="connection-diagram">
                    <pre>
USB 5V (핀16)
    │
    ├─ ESP32-C3 내부 레귤레이터 → 3.3V (핀14)
    │                                  │
    │                                  ├─ AHT20 (VCC)
    │                                  ├─ OLED (VCC)
    │                                  ├─ R1, R2, R3 (풀업)
    │                                  └─ 기타 3.3V 디바이스
    │
    └─ WS2812 LED (5V 직접 공급)

GND (핀15) - 공통 접지
                    </pre>
                </div>
            </div>

            <!-- 오류 원인 분석 -->
            <div class="section">
                <h2>🔍 이전 오류 원인 상세 분석</h2>

                <h3>1. 핀 배치 오독 원인 - 근본 분석</h3>
                <div class="highlight-box important">
                    <h4>❌ 왜 반복적으로 틀렸는가?</h4>

                    <p><strong>핵심 문제:</strong> GPIO 번호와 Net Label을 혼동하여 매핑</p>

                    <h5 style="margin-top: 15px;">오류 패턴 1: GPIO 번호 순서대로 기능을 가정</h5>
                    <ul>
                        <li><strong>잘못된 추론:</strong> "GPIO 번호가 순차적이니까 기능도 순차적일 것"</li>
                        <li><strong>예시:</strong> GPIO0→TP1, GPIO1→TP2, GPIO3→DIN, GPIO4→SS 라고 추측</li>
                        <li><strong>실제:</strong> GPIO0→SS, GPIO1→DIN, GPIO3→TP2, GPIO4→TP1</li>
                        <li><strong>교훈:</strong> GPIO 번호와 기능 배치는 무관! 회로도 설계자가 편의대로 배치함</li>
                    </ul>

                    <h5 style="margin-top: 15px;">오류 패턴 2: 심볼 핀 위치를 읽는 방향 착각</h5>
                    <ul>
                        <li><strong>가정:</strong> 오른쪽 핀들을 위→아래 또는 아래→위로 순차적으로 읽음</li>
                        <li><strong>실제:</strong> 회로도 심볼은 그리기 편의상 배치, 핀 번호는 물리적 위치와 무관</li>
                        <li><strong>증거:</strong> 핀9(GPIO0), 핀10(GPIO1), 핀11(GPIO2)까지는 순차적이지만</li>
                        <li>핀12는 GPIO3, 핀13은 GPIO4로 건너뜀 (GPIO4가 왜 마지막?)</li>
                    </ul>

                    <h5 style="margin-top: 15px;">오류 패턴 3: Net Label 이름의 의미론적 추측</h5>
                    <ul>
                        <li><strong>잘못된 추론:</strong> "TP1이 TP2보다 먼저니까 GPIO 번호도 작을 것"</li>
                        <li><strong>실제:</strong> TP1=GPIO4, TP2=GPIO3 (번호 역순!)</li>
                        <li><strong>원인:</strong> PCB 레이아웃에서 테스트 포인트 물리적 위치에 따라 번호 부여</li>
                    </ul>

                    <h5 style="margin-top: 15px;">오류 패턴 4: 기능 이름으로 GPIO 번호 유추</h5>
                    <ul>
                        <li><strong>잘못된 추론:</strong> "SS는 SPI이니까 SPI 그룹(GPIO8,9,10) 옆에 있을 것"</li>
                        <li><strong>실제:</strong> SS=GPIO0 (전혀 다른 위치)</li>
                        <li><strong>실제:</strong> DIN=GPIO1 (WS2812용인데 GPIO3이 아님!)</li>
                    </ul>

                    <h5 style="margin-top: 15px; color: #dc3545;">🔴 근본 원인: "추론" 대신 "추적" 해야 함!</h5>
                    <p><strong>잘못된 방법:</strong></p>
                    <ol>
                        <li>GPIO 번호 보기 → 기능 이름 유추 → 테이블 작성 ❌</li>
                        <li>심볼 핀 위치 보기 → 순서대로 읽기 → 매핑 ❌</li>
                        <li>기능 이름 보기 → 비슷한 것끼리 묶기 → 가정 ❌</li>
                    </ol>

                    <p><strong>올바른 방법:</strong></p>
                    <ol>
                        <li>U1 심볼 핀1 찾기 → 핀1에서 나가는 선 추적 → Net Label 확인</li>
                        <li>Net Label "SWITCH" 확인 → "SWITCH"로 연결된 부품 찾기 → SW1 확인</li>
                        <li>모든 핀에 대해 반복 (추측 금지!) ✅</li>
                    </ol>
                </div>

                <h3>2. TX/RX 혼동</h3>
                <div class="highlight-box">
                    <h4>표기 방식 차이</h4>
                    <ul>
                        <li><strong>회로도:</strong> GPIO20=RX, GPIO21=TX (ESP32 관점)</li>
                        <li><strong>오류:</strong> 일반적인 순서(TX가 더 작은 번호)로 추측하여 반대로 표기</li>
                        <li><strong>교훈:</strong> 회로도의 net label을 정확히 추적해야 함</li>
                    </ul>
                </div>

                <h3>3. 향후 방지 대책</h3>
                <div class="highlight-box success">
                    <h4>✅ 회로도 분석 체크리스트</h4>
                    <ol>
                        <li>회로도 심볼의 각 핀 번호 확인</li>
                        <li>각 핀에서 나가는 net label 정확히 추적</li>
                        <li>Net label이 연결된 실제 부품 확인</li>
                        <li>물리적 배치가 아닌 논리적 연결 우선</li>
                        <li>추측하지 않고 회로도에 명시된 정보만 사용</li>
                    </ol>
                </div>

                <h3>4. PROJECT-STATUS.md 기록사항</h3>
                <div class="highlight-box">
                    <h4>향후 세션에서 참고할 내용</h4>
                    <ul>
                        <li><strong>I2C:</strong> GPIO6=SDA, GPIO7=SCL (확정)</li>
                        <li><strong>UART:</strong> GPIO20=RX, GPIO21=TX (확정)</li>
                        <li><strong>회로도 파일:</strong> esp32c3_ai_super.pdf (검증됨)</li>
                        <li><strong>주의:</strong> PDF 회로도 시각적 해석 시 net label 정확히 추적 필요</li>
                        <li><strong>교훈:</strong> 추측하지 말고 회로도 정보만 사용</li>
                    </ul>
                </div>
            </div>

            <!-- 정확한 요약 -->
            <div class="section">
                <h2>📊 정확한 GPIO 사용 현황</h2>

                <table class="pin-table">
                    <thead>
                        <tr>
                            <th>기능</th>
                            <th>GPIO 핀</th>
                            <th>사용 상태</th>
                            <th>비고</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge i2c">I2C</span></td>
                            <td>GPIO6 (SDA), GPIO7 (SCL)</td>
                            <td>✅ 사용 중</td>
                            <td>AHT20 센서 연결</td>
                        </tr>
                        <tr>
                            <td><span class="badge uart">UART</span></td>
                            <td>GPIO20 (RX), GPIO21 (TX)</td>
                            <td>⚪ 예비</td>
                            <td>테스트 포인트</td>
                        </tr>
                        <tr>
                            <td><span class="badge gpio">SPI</span></td>
                            <td>GPIO8, 9, 10, 4</td>
                            <td>⚪ 예비</td>
                            <td>SCK, MISO, MOSI, SS</td>
                        </tr>
                        <tr>
                            <td><span class="badge gpio">입력</span></td>
                            <td>GPIO5</td>
                            <td>✅ 사용 중</td>
                            <td>택트 스위치</td>
                        </tr>
                        <tr>
                            <td><span class="badge gpio">출력</span></td>
                            <td>GPIO1 (LED), GPIO2 (부저)</td>
                            <td>✅ 사용 중</td>
                            <td>WS2812, BUZZER</td>
                        </tr>
                        <tr>
                            <td><span class="badge gpio">범용</span></td>
                            <td>GPIO0 (SS), GPIO3, GPIO4</td>
                            <td>⚪ 예비</td>
                            <td>테스트 포인트</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <footer>
            <p><strong>ESP32-C3 SuperMini 회로도 분석 (수정 버전)</strong></p>
            <p>온습도 모니터링 시스템 - 정확한 하드웨어 문서</p>
            <p>최초 작성: 2025-11-15 (오류 포함)</p>
            <p>수정 완료: 2025-11-15 (오류 정정)</p>
            <p>© 2025 Weather Monitoring Project</p>
        </footer>
    </div>
</body>
</html>
